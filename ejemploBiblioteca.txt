from biblioteca import Biblioteca;

Prop Usuario(Usuario){libros_prestados};
Prop Profesor(Usuario);
Prop Becario(Usuario);
Prop Sancionado(Usuario);
Prop Prestamos(Usuario,Libro);
Prop Libro(Libro);
Prop Disponible(Libro);

Accion PrestarLibro(Usuario,Libro):
"""
Descripción:Se registra el prestamos de un libro a un Usuario.
Entrada:(Usuario,Libro)
"""
    Condiciones:
        U = Usuario(Usuario);
        OR(
            U.libros_prestados < 3; 
            Profesor(U);//Los profesores no tiene limite
        );
        NOT ( Sancionado(Usuario) );
        NOT ( Prestamos(_,Libro) );
    Consecuencias:
        Prestamos(Usuario,Libro);
        U.libros_prestados += 1;
        Biblioteca.concederPrestamo(Usuario,Libro);

Accion Sancionar(Usuario):
    Condiciones:
        Usuario(Usuario);
        NOT(Profesor(Usuario)); //Los profesores no pueden ser sancionados
    Consecuencias:
        Sancionado(Usuario);
        Biblioteca.print("Usuario Sancionado");

Accion DevolverLibro(Libro):
    Condiciones:
        Libro(Libro);
        P = Prestamos(_,Libro);
    Consecuencias:
        Biblioteca.print("Libro devuelto");

Accion MostrarLibros():
    Condiciones:
        L = Libro(_);
    Consecuencias:
        Biblioteca.print("Libros registrados");
        Biblioteca.print(L.Libro);

Accion MostrarUsuarios():
    Condiciones:
        U = Usuario(_);
    Consecuencias:
        Biblioteca.print("Usuarios registrados");
        Biblioteca.print(U.Usuario);

Accion MostrarLibrosPrestados():
    Condiciones:
        P = Prestamos(_,_);
    Consecuencias:
        Biblioteca.print("Prestamos registrados");
        Biblioteca.print(P.Libro);

//Inicializacion
add Usuario(“nacho”){libros_prestados=0};
add Profesor(“nacho”); // Nacho es profesor, no tiene limite de libros
add Usuario(“juan”){libros_prestados=0};
add Libro(“El señor de los anillos”);
//add Libro(“El señor de los anillos”);
add Disponible(“El señor de los anillos”); // Marca como disponible
add Libro(“El Quijote”);
//add Libro(“El Quijote”);
add Disponible(“El Quijote”); // Marca como disponible
add Libro(“1984”);
//add Libro(“1984”);
add Disponible(“1984”); // Marca como disponible
add Libro(“Dune”);
//add Libro(“Dune”);
add Disponible(“Dune”); // Marca como disponible

add Prestamos("nacho",“El señor de los anillos”) ;
add Prestamos("juan",“1984”);
add Prestamos("nacho",“Dune”);

//Test
Run PrestarLibro(“nacho”, “El señor de los anillos”);
Run DevolverLibro(“El señor de los anillos”);
Run MostrarLibros();
Run MostrarUsuarios();
Run MostrarLibrosPrestados();